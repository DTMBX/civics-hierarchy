# Citation Export System Documentation

## Overview

The Civics Stack Citation Export System provides court-defensible citation generation and export functionality with full verification metadata, audit trails, and support for multiple citation styles and export formats.

## Key Features

### Court-Defensible Standards

All citations generated by this system meet the following standards:

1. **Traceability**: Every citation is traceable to primary sources with official URLs
2. **Verification Metadata**: Includes verification status, last-verified dates, and verification methods
3. **Audit Trails**: Immutable audit log entries for every export action
4. **Legal Disclaimers**: Clear disclaimers about educational purpose and requirement to cite official sources for court filings
5. **Timestamp Records**: Complete timestamp chain from retrieval to export
6. **Version Control**: Document version information and superseded status tracking

### Supported Citation Styles

#### Bluebook (Legal Standard)
- Primary legal citation format used in U.S. courts and legal academia
- Supports constitutions, statutes, treaties, regulations, and ordinances
- Properly formatted with abbreviations and pinpoint citations

#### ALWD (Alternative Legal Citation)
- Modern alternative to Bluebook preferred by some legal professionals
- Simplified rules while maintaining authority

#### APA (Academic/Social Sciences)
- American Psychological Association format
- Common in academic and policy research

#### MLA (Academic/Humanities)
- Modern Language Association format
- Used in humanities research and education

#### Chicago (Academic/Professional)
- Chicago Manual of Style format
- Common in professional and historical research

#### Court Filing Format
- Specialized format for court submissions
- Includes prominent disclaimers about citing official sources
- Enhanced verification metadata

#### BibTeX (Academic LaTeX)
- Format for LaTeX document preparation
- Used in academic publishing

#### Plain Text
- Human-readable plain language format
- Accessible format for general use

#### JSON
- Machine-readable structured format
- For programmatic access and API integration

## Export Formats

### Text (.txt)
- Plain text format with clear section headers
- Includes full citation, metadata, verification chain, and disclaimers
- Suitable for email, documents, and general use

### Markdown (.md)
- Formatted markdown with headers, lists, and code blocks
- Suitable for GitHub, documentation systems, and content management
- Maintains structure while remaining human-readable

### HTML (.html)
- Fully formatted web page with CSS styling
- Print-ready with proper page breaks
- Professional appearance suitable for sharing and archival

### JSON (.json)
- Structured data format
- Includes all metadata, verification chain, and disclaimers
- Suitable for API consumption, data analysis, and system integration

### CSV (.csv)
- Spreadsheet-compatible format
- Key-value pairs for easy import into Excel/Google Sheets
- Suitable for data analysis and record keeping

### BibTeX (.bib)
- LaTeX bibliography format
- Direct integration with academic paper workflows
- Used in academic publishing systems

## Export Options

### Include Full Text
- When enabled: Exports complete section text
- When disabled: Exports citation only
- Use case: Enable for comprehensive documentation, disable for citation lists

### Include Metadata
- Document details (title, type, authority level)
- Jurisdiction information
- Section reference and canonical citation
- Official source URL
- Verification status and dates
- Export metadata (date, user, audit trail ID)

### Include Verification Chain
- Step-by-step verification process
- Timestamps for each verification step
- Verification method and verified-by information
- Verification standards documentation

### Include Audit Trail ID
- Unique identifier linking export to audit log
- Enables tracking and verification of export history
- Required for court-defensible documentation

### Include Legal Disclaimers
- "Not Legal Advice" disclaimer
- "No Attorney-Client Relationship" disclaimer
- "Verify All Sources" disclaimer
- Court filing notice about citing official sources
- Accuracy limitation notice

## Usage Guide

### Single Citation Export

1. Navigate to any legal section in the app
2. Click "Export Citation" button
3. Select citation style (Bluebook, APA, etc.)
4. Choose export format (TXT, HTML, JSON, etc.)
5. Configure options (full text, metadata, verification, disclaimers)
6. Preview the citation
7. Click "Export Citation" to download file
8. Alternative: Click "Copy" to copy citation to clipboard
9. Alternative: Click "Share" to use native share functionality

### Batch Citation Export

1. Navigate to bookmarks, search results, or library
2. Select multiple sections/provisions
3. Click "Batch Export" action
4. Review selected items (can deselect individual items)
5. Select citation style and export format
6. Configure options (applied to all items)
7. Click export to generate combined file
8. Batch exports include citation numbering and table of contents

### Quick Export

1. From any section in lists or results
2. Click quick export dropdown
3. Choose "Copy as [format]" for immediate clipboard copy
4. Or choose "Download [format]" for file export
5. No configuration dialog - uses sensible defaults

## Verification and Compliance

### Source Verification

Every exported citation includes:

- **Verification Status**: Official, Verified, or Unverified
- **Official Source URL**: Direct link to government publication
- **Last Verified Date**: When source was last checked
- **Verification Method**: How source was verified (official website, government API, certified copy, etc.)

### Audit Trail

Every export action creates an immutable audit log entry containing:

- Unique audit trail ID
- User ID of person performing export
- Timestamp of export action
- Entity type (citation or batch-citation)
- Entity ID (section ID or batch ID)
- Metadata (format, citation style, item count for batches)

Audit logs are:
- Stored persistently in the KV store
- Retained for 7+ years (2555 days minimum)
- Immutable (cannot be edited or deleted)
- Exportable for legal proceedings
- Queryable by user, date range, entity, and action

### Legal Disclaimers

All exports include required disclaimers:

1. **Not Legal Advice**: Clearly states information is educational only
2. **No Attorney-Client Relationship**: No relationship created by using exports
3. **Verify All Sources**: Users must independently verify with official sources
4. **Court Filing Notice**: For court use, cite official government publications directly
5. **Accuracy Limitations**: No guarantees of perfection, users assume risk

### Court Defensibility

The export system is designed to be court-defensible by:

1. **Primary Source Citations**: All citations trace to official government sources
2. **Verification Metadata**: Clear documentation of verification status and dates
3. **Audit Trails**: Complete chain of custody and access records
4. **Disclaimer Compliance**: Clear boundaries around educational vs. legal advice
5. **Timestamp Integrity**: Immutable timestamps for all actions
6. **Version Control**: Document version tracking and superseded status
7. **Standards Compliance**: Adherence to COMPLIANCE_STANDARDS defined in compliance.ts

However, the exports themselves are:
- **Not admissible as legal authority** in court proceedings
- **Secondary sources** requiring citation to official publications
- **Research aids** to help locate official sources
- **Educational tools** not substitutes for official legal research

## Technical Implementation

### Core Functions

- `generateCitation()`: Creates formatted citation from metadata
- `generateCourtDefensibleExport()`: Generates complete export package with verification
- `downloadExport()`: Handles file download in specified format
- `formatExportAsText()`: Formats export as plain text
- `formatExportAsMarkdown()`: Formats export as markdown
- `formatExportAsHTML()`: Formats export as HTML web page
- `formatExportAsJSON()`: Formats export as JSON structure
- `formatExportAsCSV()`: Formats export as CSV spreadsheet

### React Components

- `CitationExportDialog`: Full-featured export dialog with all options
- `CitationBatchExport`: Batch export for multiple citations
- `QuickExportButton`: Dropdown for quick copy/export actions

### Integration Points

- Section detail view: "Export Citation" primary action
- Bookmark lists: Batch export for saved citations
- Search results: Batch export for search results
- Library views: Batch export for document sections

## Best Practices

### For Journalists

1. Use Bluebook or Plain Text format for readability
2. Always include full text and metadata
3. Include verification chain to document source reliability
4. Export as HTML for print-ready formatting
5. Keep audit trail IDs for reference verification

### For Educators

1. Use APA or MLA format for academic consistency
2. Include disclaimers to emphasize educational purpose
3. Export as PDF (via HTML) for distribution to students
4. Batch export for reading lists and course materials
5. Use markdown format for integration with course websites

### For Advocates

1. Use Court Filing format when preparing legal documents
2. Always include verification metadata
3. Note disclaimer about citing official sources for court use
4. Keep audit trail records for accountability
5. Batch export for policy briefs and advocacy materials

### For Researchers

1. Use BibTeX for academic paper integration
2. Export as JSON for data analysis
3. Include full metadata for comprehensive documentation
4. Use batch export for systematic reviews
5. Maintain audit trail IDs in research records

## Limitations

### Not a Replacement for Official Sources

- This system is an educational tool
- For court filings, legal briefs, and official submissions, always cite:
  - Official government publications
  - Statutory compilations
  - Official reporters
  - Government websites and archives

### Verification Intervals

- Sources are verified on 90-day cycles (maximum)
- Laws may change between verification cycles
- Users must independently verify current status
- "Last Verified" date indicates when source was checked

### No Legal Advice

- System does not provide legal advice
- Does not create attorney-client relationship
- Does not guarantee accuracy or completeness
- Users assume all risk of reliance

## Support and Questions

For questions about citation export functionality:

1. Review this documentation
2. Check the PRD.md for feature specifications
3. Review COMPLIANCE.md for verification standards
4. Check audit logs for export history
5. Consult with legal professionals for court filing requirements

## Version History

- **v1.0** (2024): Initial implementation with court-defensible standards
  - Multiple citation formats (Bluebook, ALWD, APA, MLA, Chicago, BibTeX, Plain, Court Filing, JSON)
  - Multiple export formats (TXT, MD, HTML, JSON, CSV, BibTeX)
  - Complete verification metadata
  - Immutable audit trails
  - Batch export functionality
  - Quick export actions
  - Comprehensive legal disclaimers
